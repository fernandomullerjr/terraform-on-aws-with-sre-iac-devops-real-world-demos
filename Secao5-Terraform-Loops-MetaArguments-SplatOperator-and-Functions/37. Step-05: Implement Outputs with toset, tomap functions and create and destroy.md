
# ############################################################################
# ############################################################################
# ############################################################################
# Git - Efetuando Push

git status
git add .
git commit -m "37. Step-05: Implement Outputs with toset, tomap functions and create and destroy."
git push
git status


# ############################################################################
# ############################################################################
# ############################################################################
# 37. Step-05: Implement Outputs with toset, tomap functions and create and destroy


## Step-04: c6-outputs.tf
```tf

# EC2 Instance Public IP with TOSET
output "instance_publicip" {
  description = "EC2 Instance Public IP"
  #value = aws_instance.myec2vm.*.public_ip   # Legacy Splat
  #value = aws_instance.myec2vm[*].public_ip  # Latest Splat
  value = toset([
      for myec2vm in aws_instance.myec2vm : myec2vm.public_ip
    ])  
}

# EC2 Instance Public DNS with TOSET
output "instance_publicdns" {
  description = "EC2 Instance Public DNS"
  #value = aws_instance.myec2vm[*].public_dns  # Legacy Splat
  #value = aws_instance.myec2vm[*].public_dns  # Latest Splat
  value = toset([
      for myec2vm in aws_instance.myec2vm : myec2vm.public_dns
    ])    
}

# EC2 Instance Public DNS with MAPS
output "instance_publicdns2" {
  value = tomap({
    for s, myec2vm in aws_instance.myec2vm : s => myec2vm.public_dns
    # S intends to be a subnet ID
  })
}
```








- Acessando diretório dos manifestos:

cd /home/fernando/cursos/terraform/terraform-on-aws-with-sre-iac-devops-real-world-demos/Secao5-Terraform-Loops-MetaArguments-SplatOperator-and-Functions/terraform-manifests


- Ao tentar fazer plan, ocorre erro:

~~~~bash
│ Error: Unsupported attribute
│
│   on c6-outputs.tf line 45, in output "latest_splat_instance_publicdns":
│   45:   value = aws_instance.myec2vm[*].public_dns
│
│ This object does not have an attribute named "public_dns".
╵
~~~~

Isto ocorre porque existe uso de Splat, que não funciona com o for_each!
Isto ocorre porque existe uso de Splat, que não funciona com o for_each!
Isto ocorre porque existe uso de Splat, que não funciona com o for_each!
Isto ocorre porque existe uso de Splat, que não funciona com o for_each!



# ############################################################################
# ############################################################################
# ############################################################################
# RESUMO

- Splat não trabalha com for_each.

- Splat é usado principalmente para listas, conjuntos e tuplas, não para mapas ou recursos for_each.

- O meta-argumento for_each aceita um map ou um conjunto de strings e cria uma instância para cada item nesse map ou set.